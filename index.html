<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Школьное расписание</title>
    <meta name="description" content="Просмотр школьного расписания для классов.">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>Школьное расписание</h1>
    </header>

    <main>
        <div class="class-buttons">
            <button class="class-button" onclick="showSchedule('5а')">5а</button>
            <button class="class-button" onclick="showSchedule('5б')">5б</button>
            <button class="class-button" onclick="showSchedule('5в')">5в</button>
            <button class="class-button" onclick="showSchedule('5г')">5г</button>
            <button class="class-button" onclick="showSchedule('6а')">6а</button>
            <button class="class-button" onclick="showSchedule('6б')">6б</button>
            <button class="class-button" onclick="showSchedule('6в')">6в</button>
            <button class="class-button" onclick="showSchedule('7а')">7а</button>
            <button class="class-button" onclick="showSchedule('7б')">7б</button>
            <button class="class-button" onclick="showSchedule('7в')">7в</button>
            <button class="class-button" onclick="showSchedule('8а')">8а</button>
            <button class="class-button" onclick="showSchedule('9а')">9а</button>
            <button class="class-button" onclick="showSchedule('10ен')">10ен</button>
            <button class="class-button" onclick="showSchedule('11ен')">11ен</button>
        </div>

        <div id="currentLesson"></div>

        <a href="form.html" class="form-button">Заполнить расписание</a>
    </main>

    <script>
        const scheduleUrl = 'https://gist.githubusercontent.com/3-School-Achinsk/4b7c67ffb92982bfebd3511f702756e3/raw/79bf1323d0336531e9fc5cd7db016078da34b85a/schedules.json'; // Ваш Raw URL

        const lessonTimes = {
            '1': { start: '04:00', end: '04:40' },
            '2': { start: '04:50', end: '05:30' },
            '3': { start: '05:40', end: '06:20' },
            '4': { start: '06:40', end: '07:20' },
            '5': { start: '07:40', end: '08:20' },
            '6': { start: '08:30', end: '09:10' },
            '7': { start: '13:20', end: '14:00' }
        };

        const breakTimes = {
            '1': { start: '04:40', end: '04:50' },
            '2': { start: '05:30', end: '05:40' },
            '3': { start: '06:20', end: '06:40' },
            '4': { start: '07:20', end: '07:40' },
            '5': { start: '08:20', end: '08:30' },
            '6': { start: '09:10', end: '09:20' }
        };

        let schedules = {};

        async function loadSchedules() {
            const response = await fetch(scheduleUrl);
            return await response.json();
        }

        loadSchedules().then(data => {
            schedules = data;
            displayCurrentLesson();
        });

        function showSchedule(className) {
            const schedule = schedules[className] || 'Расписание не найдено.';
            const lessonsArray = schedule.split(', ').map(lesson => {
                const [number, subject] = lesson.split(' ');
                return { number, subject };
            });

            // Сортировка по номеру урока
            lessonsArray.sort((a, b) => a.number - b.number);

            // Формирование строки для нового окна
            const scheduleContent = lessonsArray.map(lesson => `${lesson.number} Урок: ${lesson.subject}`).join('\n');

            const newWindow = window.open('', 'Расписание класса', 'width=300,height=400');
            newWindow.document.write(`<pre>${scheduleContent}</pre>`);
            newWindow.document.close();
        }

        function displayCurrentLesson() {
            const now = new Date();
            const currentTime = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
            let currentLesson = 'Сейчас нет уроков или перемен.';

            // Определение текущего урока или перемены
            for (const [lessonNumber, times] of Object.entries(lessonTimes)) {
                if (currentTime >= times.start && currentTime < times.end) {
                    currentLesson = `Текущий урок: ${lessonNumber} `;
                }
            }

            for (const [breakNumber, times] of Object.entries(breakTimes)) {
                if (currentTime >= times.start && currentTime < times.end) {
                    currentLesson = `Перемена ${breakNumber} `;
                }
            }

            document.getElementById('currentLesson').innerText = currentLesson;
        }
    </script>
</body>
</html>
